<div ng-if="appDelLogsCtrl.hasProject === null" class="message-box message-box-no-bg">
  <bounce-spinner classes="bounce-spinner-sm"></bounce-spinner>
</div>
<div ng-if="appDelLogsCtrl.hasProject === 'error'" class="message-box message-box-no-bg">
  <div translate>An error occurred retrieving delivery logs</div>
</div>
<div ng-if="appDelLogsCtrl.hasProject === false" class="message-box message-box-no-bg">
  <p>
  <div class="helion-icon helion-icon-3x helion-icon-Continuous_integration"></div>
  <h3 translate>You have not set up a delivery pipeline</h3>
  </p>
  <button class="btn btn-primary" translate>set up delivery pipeline</button>
</div>
<div ng-if="appDelLogsCtrl.hasProject === true">
  <div id="delivery-logs-summary" class="panel panel-default delivery-logs-summary">
    <div class="panel-heading action-header">
      <span translate>Summary</span>
    </div>

    <dl class="dl-horizontal">
      <dt translate>LAST BUILD</dt>
      <dd>
        <a ng-if="appDelLogsCtrl.last.building" class="" href=""
           ng-click="appDelLogsCtrl.views.viewEvent.open(appDelLogsCtrl.last.building, appDelLogsCtrl.hceCnsi.guid)">
          {{ appDelLogsCtrl.last.building.id }}</a>
        <span ng-if="appDelLogsCtrl.last.building" am-time-ago="appDelLogsCtrl.last.building.endDate"></span>
        <span ng-if="!appDelLogsCtrl.last.building" translate>None</span>
      </dd>
      <dt translate>LAST TEST</dt>
      <dd>
        <a ng-if="appDelLogsCtrl.last.testing" class="" href=""
           ng-click="appDelLogsCtrl.views.viewEvent.open(appDelLogsCtrl.last.testing, appDelLogsCtrl.hceCnsi.guid)">
          {{ appDelLogsCtrl.last.testing.id }}</a>
        <span ng-if="appDelLogsCtrl.last.testing" am-time-ago="appDelLogsCtrl.last.testing.endDate"></span>
        <span ng-if="!appDelLogsCtrl.last.testing" translate>None</span>
      </dd>
      <dt translate>LAST DEPLOYMENT</dt>
      <dd>
        <a ng-if="appDelLogsCtrl.last.deploying" class="" href=""
           ng-click="appDelLogsCtrl.views.viewEvent.open(appDelLogsCtrl.last.deploying, appDelLogsCtrl.hceCnsi.guid)">
          {{ appDelLogsCtrl.last.deploying.id }}</a>
        <span ng-if="appDelLogsCtrl.last.deploying" am-time-ago="appDelLogsCtrl.last.deploying.endDate"></span>
        <span ng-if="!appDelLogsCtrl.last.deploying" translate>None</span>
      </dd>
    </dl>
  </div>
  <div id="delivery-logs"
       st-table="appDelLogsCtrl.displayedExecutions"
       st-safe-src="appDelLogsCtrl.parsedHceModel.pipelineExecutions"
       st-set-filter="deliveryLogsBuildFilter"
       >
    <div id="delivery-logs-search" class="panel panel-default delivery-logs-search">
      <form>
        <div class="form-group search-field" focusable-input>
          <label class="control-label" for="build-search" required translate>
            Search Builds
          </label>
          <div>
            <input ng-model="appDelLogsCtrl.searchValue" type="text" class="form-control" id="build-search" st-search>
            <i class="helion-icon helion-icon-Search"></i>
          </div>
        </div>
      </form>
    </div>

    <div id="delivery-logs-builds" class="delivery-logs-builds">
      <div class="action-header">
        <span translate>Builds</span>
        <a class="btn btn-link" href="" ng-click="appDelLogsCtrl.triggerBuild()">
          <i class="helion-icon helion-icon-Right_Arrow"></i>
          <span translate>Trigger Build</span>
        </a>
      </div>
      <div class="panel panel-default">
        <table class="table table-actionable" >
          <thead>
          <tr>
            <th st-sort="message" translate>MESSAGE</th>
            <th translate>RESULT</th>
            <th st-sort="reason.mCreatedDate" st-sort-default="reverse" translate>TIME</th>
            <th st-sort="reason.author" translate>COMMIT AUTHOR</th>
            <th st-sort="reason.type" translate>REASON</th>
          </tr>
          </thead>
          <tbody>
          <tr
            ng-repeat="execution in appDelLogsCtrl.displayedExecutions">
            <td><a href="" ng-click="appDelLogsCtrl.viewExecution(execution)">{{ execution.message }}</a></td>
            <td ng-if="!execution.result" class="row result-col">
            <td ng-if="execution.result" class="row result-col" id="build-result-col">
              <div ng-switch="execution.result.state" class="pull-left">
                <span ng-switch-when="succeeded" class="helion-icon helion-icon-Active_S text-primary"></span>
                <span ng-switch-when="running"><spinner></spinner></span>
                <span ng-switch-when="failed" class="helion-icon helion-icon-Critical_S text-danger"></span>
                <span ng-switch-default class="helion-icon helion-icon-Active_S"></span>
              </div>
              <span translate>{{ execution.result.label }}</span>
              <a translate
                 ng-if="execution.result.state === appDelLogsCtrl.eventStates.SUCCEEDED &&
                        appCtrl.model.application.summary.routes[0]"
                 target="_blank"
                 ng-init="route=appCtrl.model.application.summary.routes[0]"
                 ng-href="http://{{ route.host + '.' + route.domain.name + (route.port ? ':' + route.port : '') + route.path }}">view</a>
            </td>
            <td>{{ execution.reason.createdDate | amDateFormat:'L - LTS' }}</td>
            <td>{{ execution.reason.author }}</td>
            <td>{{ execution.reason.type }}</td>
          </tr>
          </tbody>
          <tfoot ng-init="appDelLogsCtrl.showExecutions = 5"
                 ng-show="appDelLogsCtrl.showExecutions < appDelLogsCtrl.parsedHceModel.pipelineExecutions.length">
          <tr>
            <td colspan="5" class="text-center">
              <a ng-click="appDelLogsCtrl.showExecutions = appDelLogsCtrl.parsedHceModel.pipelineExecutions.length">
                <span translate>Show All</span> ({{appDelLogsCtrl.parsedHceModel.pipelineExecutions.length}})
              </a>
              <div ng-show="false" st-pagination="" st-items-by-page="appDelLogsCtrl.showExecutions"></div>
            </td>
          </tr>
          </tfoot>
        </table>
      </div>

    </div>
  </div>
</div>



