<div class="endpoints endpoints-dashboard">
  <div class="header">
    <div class="applications-header font-semi-bold pull-left" translate>
      Service Manager
      <bounce-spinner classes="bounce-spinner-sm" ng-if="!svcsCtrl.initialised"></bounce-spinner>
    </div>
    <!--
    <button ng-if="svcsCtrl.initialised &&
                     svcsCtrl.isUserAdmin()"
            class="btn btn-primary" stlye="position: absolute; right: 0px;"
            ng-click="svcsCtrl.register()" translate>Register Endpoint
    </button>
    -->
  </div>
  <div class="console-error console-error-block" ng-if="svcsCtrl.initialised && svcsCtrl.listError">
    <div>
      <div class="helion-icon helion-icon-3x helion-icon-Critical_L"></div>
      <div class="applications-msg" translate>The {{ OEM_CONFIG.CONSOLE }} could not retrieve Service Manager information.</div>
      <button ng-click="svcsCtrl.reload()" class="btn btn-primary" translate>Retry</button>
    </div>
  </div>
    <div ng-if="svcsCtrl.instances.length === 0"
         class="applications-empty" translate>
        There are no services. This is most likely an error.
    </div>
    <div ng-if="svcsCtrl.instances.length" class="endpoints-table">
      <table class="table table-actionable"
             st-table="svcsCtrl.stTableInstances"
             st-safe-src="svcsCtrl.instances">
        <thead>
        <tr>
          <th translate st-sort="instance_id" st-sort-default="true" st-skip-natural="true">Instance ID</th>
          <th translate st-sort="state" st-skip-natural="true">State</th>
          <th translate st-sort="service_id" st-skip-natural="true">Service ID</th>
          <th translate st-sort="product_version" st-skip-natural="true">Product Version</th>
          <th translate st-sort="sdl_version" st-skip-natural="true">SDL Version</th>
          <th translate st-sort="vendor" st-skip-natural="true">Vendor</th>
          <th></th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="endpoint in svcsCtrl.stTableInstances track by endpoint.instance_id"
            show-table-inline-message="{{endpoint.error ? endpoint.error.message : ''}}"
            inline-message-colspan="7"
            inline-message-link="{ ref: 'neil.route', params: { id: endpoint.instance_id } }"
            table-inline-status="{{ endpoint.error.status }}">

          <!--Endpoint Name-->
          <td ng-if="endpoint.visit">
            <a ng-href="{{endpoint.visit()}}">{{ endpoint.instance_id }}</a>
          </td>
          <td ng-if="!endpoint.visit">{{ endpoint.instance_id }}</td>

          <!--Endpoint Connection Status-->
          <td ng-switch="endpoint.state" class="endpoint-table-connected">
            <span class="helion-icon helion-icon-lg helion-icon-Active_L text-primary"
                  ng-switch-when="running"></span>
            <div ng-switch-when="error"
                 uib-popover="{{ 'Disconnected' | translate }}"
                 popover-trigger="'mouseenter'"
                 popover-placement="top-left"
                 popover-popup-delay="1000">
              <svg-image src="/svg/NoConnection_Black.svg"></svg-image>
            </div>
            <span class="helion-icon helion-icon-lg helion-icon-Critical_L text-danger"
                  ng-switch-when="expired"></span>
            <span class="helion-icon helion-icon-lg helion-icon-Critical_L text-danger"
                  ng-switch-when="pending"></span>
            <span class="helion-icon helion-icon-lg helion-icon-Warning_L text-warning"
                  ng-switch-when="complicated"></span>
          </td>

          <td>{{ endpoint.service_id }}</td>
          <td>{{ endpoint.product_version }}</td>
          <td>{{ endpoint.sdl_version }}</td>
          <td>{{ endpoint.vendor }}</td>
          <td>
            <actions-menu actions="endpoint.actions"
                          action-target="endpoint.actionsTarget"
                          menu-icon="helion-icon helion-icon-More"
                          menu-position="actions-menu-right"
                          enable-button-mode="true"></actions-menu>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
