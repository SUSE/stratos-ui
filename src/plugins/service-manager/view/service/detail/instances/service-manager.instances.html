<div ng-if="!smCtrl.model.instances && smCtrl.model.instances !== false"
     class="cluster-loading message-box message-box-no-bg">
  <bounce-spinner classes="bounce-spinner-sm"></bounce-spinner>
</div>
<div ng-if="clusterDetailController.organizations === false" class="cluster-loading col-md-9 col-sm-12">
  <div translate>An error occurred retrieving instances</div>
</div>
<div class="cluster-gallery-card-container" ng-if="smCtrl.model.instances">
  <div ng-if="smCtrl.model.instances.length < 1"
       class="panel panel-default cluster-empty-list">
    <div class="panel-body" translate>
      You have no instances
    </div>
  </div>
    <table ng-if="smCtrl.model.instances.length" class="table table-actionable"
            st-table="svcsCtrl.stTableInstances"
            st-safe-src="smCtrl.model.instances">
      <thead>
      <tr>
        <th translate st-sort="instance_id" st-sort-default="true" st-skip-natural="true">Instance ID</th>
        <th translate st-sort="state" st-skip-natural="true">State</th>
        <th translate st-sort="service_id" st-skip-natural="true">Service ID</th>
        <th translate st-sort="product_version" st-skip-natural="true">Product Version</th>
        <th translate st-sort="sdl_version" st-skip-natural="true">SDL Version</th>
        <th translate st-sort="vendor" st-skip-natural="true">Vendor</th>
         <th translate>CPU Usage</th>
      <th translate>Memory Usage</th>
<th></th>
      </tr>
      </thead>
      <tbody>
      <tr ng-repeat="endpoint in svcsCtrl.stTableInstances track by endpoint.instance_id">
        <td >
          <a ng-click="instancesCtrl.open(endpoint)">{{ endpoint.instance_id }}</a>
        </td>

        <!--Endpoint Connection Status-->
        <td ng-switch="endpoint.state" class="endpoint-table-connected">
          <span class="helion-icon helion-icon-lg helion-icon-Active_L text-primary"
                ng-switch-when="running"></span>
        <div ng-switch-when="error"
             uib-popover="{{ 'Disconnected' | translate }}"
             popover-trigger="'mouseenter'"
             popover-placement="top-left"
             popover-popup-delay="1000">
          <svg-image src="/svg/NoConnection_Black.svg"></svg-image>
        </div>
        <span class="helion-icon helion-icon-lg helion-icon-Critical_L text-danger"
              ng-switch-when="expired"></span>
        <span class="helion-icon helion-icon-lg helion-icon-Critical_L text-danger"
              ng-switch-when="pending"></span>
        <span class="helion-icon helion-icon-lg helion-icon-Warning_L text-warning"
              ng-switch-when="complicated"></span>
      </td>

        <td>
          <a ui-sref="sm.endpoint.service.detail({id:  endpoint.service_id })">
          {{  endpoint.service_id }}
          </a>
        </td>
        <td>{{ endpoint.product_version }}</td>
        <td>
          <a ui-sref="sm.endpoint.service.sdl({id: endpoint.service_id, product: endpoint.product_version, sdl: endpoint.sdl_version})">
          {{ endpoint.sdl_version }}
          </a>
        </td>
        <td>{{ endpoint.vendor }}</td>
<td>
        <sparkline-graph ng-if="instancesCtrl.cpuUsageRate[endpoint.instance_id].length > 0"
                         timeseries="instancesCtrl.cpuUsageRate[endpoint.instance_id]"
        >
        </sparkline-graph>
        <!--<kd-sparkline ng-if="instancesCtrl.cpuUsageRate[endpoint.instance_id].length > 0"-->
        <!--class-name="expanded-kd-sparkline-cpu-series"-->
        <!--timeseries="instancesCtrl.cpuUsageRate[endpoint.instance_id]">-->
        <!--</kd-sparkline>-->
      </td>
      <td>
        <sparkline-graph ng-if="instancesCtrl.memoryUsageRate[endpoint.instance_id].length > 0"
                         timeseries="instancesCtrl.memoryUsageRate[endpoint.instance_id]"
        >
        </sparkline-graph>
        <!--<kd-sparkline ng-if="instancesCtrl.memoryUsageRate[endpoint.instance_id].length > 0"-->
        <!--class-name="expanded-kd-sparkline-memory-series"-->
        <!--timeseries="instancesCtrl.memoryUsageRate[endpoint.instance_id]">-->
        <!--</kd-sparkline>-->
      </td>
        <td>
          <!--
          <actions-menu actions="endpoint.actions"
                        action-target="endpoint.actionsTarget"
                        menu-icon="helion-icon helion-icon-More"
                        menu-position="actions-menu-right"
                        enable-button-mode="true"></actions-menu>
        -->
          <div ng-if="smCtrl.hasUpgrade(endpoint.instance_id, true)" class="upgrade-indicator">
            <i ui-sref="sm.endpoint.instance.versions({id: endpoint.instance_id})" class="helion-icon helion-icon-Upgrade"></i>
          </div>
        </td>
      </tr>
      <!--
      <tr ng-if="smCtrl.hasUpgrade(endpoint.instance_id)" ng-repeat-end>
        <td colspan="7" class="table-inline-message hsm-upgrade">
          <div>
            <div class="upgrade-message">
              <i ui-sref="sm.endpoint.instance.versions({id: endpoint.instance_id})" class="helion-icon helion-icon-Upgrade"></i>
              <a ui-sref="sm.endpoint.instance.versions({id: endpoint.instance_id})">Upgrade available</a>
            </div>
            <div class="upgrade-acknowledge">
              <i ng-click="smCtrl.acknowledgeUpgrade(endpoint.instance_id)" class="helion-icon helion-icon-Close"></i>
            </div>
          <div>
        </td>
      </tr>
      -->
      </tbody>
    </table>

<!--

  <div class="cluster-gallery-card-parent" ng-repeat="organization in clusterDetailController.organizations track by organization.guid">
    <organization-tile organization="organization" organization-names="clusterController.organizationNames"></organization-tile>
  </div>
  -->
</div>
